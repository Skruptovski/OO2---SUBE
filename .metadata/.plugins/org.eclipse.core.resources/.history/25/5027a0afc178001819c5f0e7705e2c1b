package datos;

import java.util.GregorianCalendar;
import java.util.List;
import java.util.Set;

import negocio.CargaABM;
import negocio.EstacionABM;
import negocio.TarjetaABM;
import negocio.UsuarioABM;

public class Boleteria {
	private long idBoleteria;
	private String boleteria;
	private Set<Carga> cargas;
	
	public Boleteria (){}

	public Boleteria(String boleteria) {
		this.boleteria = boleteria;
	}

	public long getIdBoleteria() {
		return idBoleteria;
	}

	protected void setIdBoleteria(long idBoleteria) {
		this.idBoleteria = idBoleteria;
	}

	public String getBoleteria() {
		return boleteria;
	}

	public void setBoleteria(String boleteria) {
		this.boleteria = boleteria;
	}

	
	public Set<Carga> getCargas() {
		return cargas;
	}

	public void setCargas(Set<Carga> cargas) {
		this.cargas = cargas;
	}
	
	public void cargarSaldo(Tarjeta tarjeta, double monto) throws Exception{
		if (tarjeta.isBaja())throw new Exception("La tarjeta fue dada de baja");
		UsuarioABM uabm = UsuarioABM.getInstanciaUsuarioABM();
		Usuario usuario = null;
		CargaABM cabm = CargaABM.getInstanciaCargaABM();
		TarjetaABM tabm = TarjetaABM.getInstanciaTarjetaABM();
		GregorianCalendar fechaHoraCarga = new GregorianCalendar();
		Boleto boletoAux = null;
		List<Boleto> listaBoletos=tabm.traerBoletosDeTarjeta(tarjeta.getIdTarjeta());
		if(!listaBoletos.isEmpty()){
			boletoAux = listaBoletos.get(listaBoletos.size()-1);
			}
		cabm.agregar(tarjeta,this, fechaHoraCarga, monto);
		double saldoNuevo = tarjeta.getSaldo()+monto;
		tarjeta.setSaldo(saldoNuevo);
		tabm.modificar(tarjeta);
		if(tarjeta.getUsuario()!=null){
			usuario = uabm.traerUsuarioYBeneficio(tarjeta.getUsuario().getIdUsuario());
			Beneficio beneficio = null;		
			if(usuario!=null){
				beneficio = usuario.getBeneficio();	
			}
			if(beneficio instanceof BoletoEstudiantil) {
				if(monto==-1){
					
				}
			
			}
		}
	}
	@Override
	public String toString() {
		return "Boleteria [idBoleteria=" + idBoleteria + ", boleteria=" + boleteria + "]";
	}
	
	

}
